#!/bin/sh

commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# ì¡°ê±´ 0: íŠ¹ì • ë””ë ‰í† ë¦¬ì— ë³€ê²½ëœ íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸
changed_files=$(git diff --cached --name-only)

apply_check=false

for file in $changed_files; do
  if echo "$file" | grep -qE '^Baekjoon/|^Programmers/'; then
    apply_check=true
    break
  fi
done

if [ "$apply_check" = false ]; then
  echo "ğŸ” Baekjoon/ ë˜ëŠ” Programmers/ ë‚´ ë³€ê²½ ì‚¬í•­ì´ ì—†ìœ¼ë¯€ë¡œ ê·œì¹™ ê²€ì‚¬ ìƒëµ"
  exit 0
fi

# ğŸ‰: ë¡œ ì‹œì‘í•´ì•¼ í•¨
if ! echo "$commit_msg" | grep -q "^ğŸ‰:"; then
  echo "âŒ ì»¤ë°‹ ë©”ì‹œì§€ëŠ” ğŸ‰: ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤."
  exit 1
fi

# '/' ê°€ ë‘ ë²ˆ ì´ìƒ í¬í•¨ë˜ì–´ì•¼ í•¨
slash_count=$(echo "$commit_msg" | grep -o "/" | wc -l)

if [ "$slash_count" -lt 2 ]; then
  echo "âŒ ì»¤ë°‹ ë©”ì‹œì§€ì—ëŠ” '/' ë¬¸ìê°€ ë‘ ë²ˆ ì´ìƒ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤."
  exit 1
fi

echo "âœ… ì»¤ë°‹ ë©”ì‹œì§€ í™•ì¸ ì™„ë£Œ"
